

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pfaffian &mdash; TeMFpy 2025 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=b9ceff23" />

  
    <link rel="shortcut icon" href="../_static/favicon.svg"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=cb975c41"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="iMPS" href="iMPS.html" />
    <link rel="prev" title="slater" href="slater.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            TeMFpy
              <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/contribute.html">Contributors’ guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/contribute.html#best-practices">Best practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/contribute.html#discuss-before-you-contribute">Discuss before you contribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/contribute.html#no-giant-prs">No giant PRs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/contribute.html#document-your-changes">Document your changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../getting_started/contribute.html#coding-style">Coding style</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../getting_started/contribute.html#how-to-submit-a-pr">How to submit a PR</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/citing.html">Citing TeMFpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/examples.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../examples/gutzwiller.html">gutzwiller.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/iMPS.html">iMPS.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/iMPS_pfaffian.html">iMPS_pfaffian.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/iMPS_slater.html">iMPS_slater.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/pfaffian.html">pfaffian.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="../examples/slater.html">slater.py</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="slater.html">slater</a><ul>
<li class="toctree-l2"><a class="reference internal" href="slater.html#classes">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes"><code class="docutils literal notranslate"><span class="pre">SchmidtModes</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.e"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.e</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.vL"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.vL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.vR"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.vR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.ixL"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.ixL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.ixR"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.ixR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.nL"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.nL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.nR"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.nR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.n_fermion"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.n_fermion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.n_entangled"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.n_entangled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.size"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.n_filled"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.n_filled()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.vL_entangled"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.vL_entangled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.vR_entangled"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.vR_entangled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.mode_vectors"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.mode_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.eigenvalues"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.eigenvalues()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.singular_values"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.singular_values</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.from_correlation_matrix"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.from_correlation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.e_ratio"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.e_ratio</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.embed_subsets"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.embed_subsets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtModes.schmidt_values"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.schmidt_values()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.modes"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.modes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.left_sets"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.left_sets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.right_sets"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.right_sets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.schmidt_values"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.schmidt_values</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.idx_L"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.idx_L</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.n_schmidt"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.n_schmidt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.n_entangled"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.n_entangled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.nL"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.nL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.nR"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.nR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.n_fermion"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.n_fermion</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.size"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.vL"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.vL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.vR"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.vR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.mode_vectors"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.mode_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.sets"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.sets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.from_schmidt_modes"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.from_schmidt_modes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.SchmidtVectors.from_correlation_matrix"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.from_correlation_matrix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData"><code class="docutils literal notranslate"><span class="pre">MPSTensorData</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData.mode"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData.physical_leg"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.physical_leg</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData.det_always"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.det_always</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData.sometimes_matrix"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.sometimes_matrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData.idx_bra"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.idx_bra</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData.idx_ket"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.idx_ket</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData.new_sets_bra"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.new_sets_bra</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData.new_sets_ket"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.new_sets_ket</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData.qtotal"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.qtotal</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData.idx_physical"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.idx_physical</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData.from_schmidt_vectors"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.from_schmidt_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="slater.html#temfpy.slater.MPSTensorData.to_npc_array"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.to_npc_array()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="slater.html#functions">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="slater.html#temfpy.slater.correlation_matrix"><code class="docutils literal notranslate"><span class="pre">correlation_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="slater.html#temfpy.slater.C_to_MPS"><code class="docutils literal notranslate"><span class="pre">C_to_MPS()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="slater.html#temfpy.slater.C_to_iMPS"><code class="docutils literal notranslate"><span class="pre">C_to_iMPS()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">pfaffian</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#representing-nambu-correlation-matrices">Representing Nambu correlation matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="#classes">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes"><code class="docutils literal notranslate"><span class="pre">SchmidtModes</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.nL"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.nL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.nR"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.nR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.e"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.e</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vL"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.vL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vR"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.vR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.pL"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.pL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.pR"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.pR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.parity"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.parity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.n_entangled"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.n_entangled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.size"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vL_entangled"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.vL_entangled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vR_entangled"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.vR_entangled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.mode_vectors"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.mode_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.eigenvalues"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.eigenvalues()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.singular_values"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.singular_values</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.from_correlation_matrix"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.from_correlation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.e_ratio"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.e_ratio</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.embed_subsets"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.embed_subsets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.schmidt_values"><code class="docutils literal notranslate"><span class="pre">SchmidtModes.schmidt_values()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.modes"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.modes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.left_sets"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.left_sets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.right_sets"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.right_sets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.schmidt_values"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.schmidt_values</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.idx_n"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.idx_n</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.idx_parity"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.idx_parity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.n_schmidt"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.n_schmidt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.n_entangled"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.n_entangled</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.nL"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.nL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.nR"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.nR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.size"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.vL"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.vL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.vR"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.vR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.mode_vectors"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.mode_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.pL"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.pL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.pR"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.pR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.parity"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.parity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.sets"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.sets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.from_schmidt_modes"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.from_schmidt_modes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.from_correlation_matrix"><code class="docutils literal notranslate"><span class="pre">SchmidtVectors.from_correlation_matrix()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData"><code class="docutils literal notranslate"><span class="pre">MPSTensorData</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.mode"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.norm"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.norm</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.pfaffian_matrix"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.pfaffian_matrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.labels"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.qtotal"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.qtotal</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.leg_bra"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.leg_bra</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.new_sets_bra"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.new_sets_bra</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.idx_n_bra"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.idx_n_bra</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.leg_idx_bra"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.leg_idx_bra</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.leg_ket"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.leg_ket</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.new_sets_ket"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.new_sets_ket</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.idx_n_ket"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.idx_n_ket</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.from_schmidt_vectors"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.from_schmidt_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.to_npc_array"><code class="docutils literal notranslate"><span class="pre">MPSTensorData.to_npc_array()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#high-level-functions">High-level functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.correlation_matrix"><code class="docutils literal notranslate"><span class="pre">correlation_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.parity"><code class="docutils literal notranslate"><span class="pre">parity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.C_to_MPS"><code class="docutils literal notranslate"><span class="pre">C_to_MPS()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.C_to_iMPS"><code class="docutils literal notranslate"><span class="pre">C_to_iMPS()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#helper-functions">Helper functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.vector_C2M"><code class="docutils literal notranslate"><span class="pre">vector_C2M()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.vector_M2C"><code class="docutils literal notranslate"><span class="pre">vector_M2C()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.matrix_C2M"><code class="docutils literal notranslate"><span class="pre">matrix_C2M()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.matrix_M2C"><code class="docutils literal notranslate"><span class="pre">matrix_M2C()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.assert_nambu"><code class="docutils literal notranslate"><span class="pre">assert_nambu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.assert_nambu_hamiltonian"><code class="docutils literal notranslate"><span class="pre">assert_nambu_hamiltonian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#temfpy.pfaffian.assert_nambu_correlation"><code class="docutils literal notranslate"><span class="pre">assert_nambu_correlation()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="iMPS.html">iMPS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="iMPS.html#temfpy.iMPS.MPS_to_iMPS"><code class="docutils literal notranslate"><span class="pre">MPS_to_iMPS()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="iMPS.html#temfpy.iMPS.overlap_schmidt"><code class="docutils literal notranslate"><span class="pre">overlap_schmidt()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="iMPS.html#temfpy.iMPS.basis_rotation"><code class="docutils literal notranslate"><span class="pre">basis_rotation()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="iMPS.html#temfpy.iMPS.iMPSError"><code class="docutils literal notranslate"><span class="pre">iMPSError</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="iMPS.html#temfpy.iMPS.iMPSError.left_unitary"><code class="docutils literal notranslate"><span class="pre">iMPSError.left_unitary</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iMPS.html#temfpy.iMPS.iMPSError.left_schmidt"><code class="docutils literal notranslate"><span class="pre">iMPSError.left_schmidt</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iMPS.html#temfpy.iMPS.iMPSError.right_unitary"><code class="docutils literal notranslate"><span class="pre">iMPSError.right_unitary</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iMPS.html#temfpy.iMPS.iMPSError.right_schmidt"><code class="docutils literal notranslate"><span class="pre">iMPSError.right_schmidt</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iMPS.html#temfpy.iMPS.iMPSError.left_total"><code class="docutils literal notranslate"><span class="pre">iMPSError.left_total</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iMPS.html#temfpy.iMPS.iMPSError.right_total"><code class="docutils literal notranslate"><span class="pre">iMPSError.right_total</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="iMPS.html#temfpy.iMPS.iMPSError.total_error"><code class="docutils literal notranslate"><span class="pre">iMPSError.total_error</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="gutzwiller.html">gutzwiller</a><ul>
<li class="toctree-l2"><a class="reference internal" href="gutzwiller.html#temfpy.gutzwiller.abrikosov_ph"><code class="docutils literal notranslate"><span class="pre">abrikosov_ph()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="testing.html#temfpy.testing.TEST_ACTION"><code class="docutils literal notranslate"><span class="pre">TEST_ACTION</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html#testing-functions">Testing functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="testing.html#temfpy.testing.assert_allclose"><code class="docutils literal notranslate"><span class="pre">assert_allclose()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#temfpy.testing.assert_array_less"><code class="docutils literal notranslate"><span class="pre">assert_array_less()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#temfpy.testing.check_schmidt_decomposition"><code class="docutils literal notranslate"><span class="pre">check_schmidt_decomposition()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="testing.html#temfpy.testing.ComparisonWarning"><code class="docutils literal notranslate"><span class="pre">ComparisonWarning</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="schmidt_utils.html">schmidt_utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="schmidt_utils.html#temfpy.schmidt_utils.StoppingCondition"><code class="docutils literal notranslate"><span class="pre">StoppingCondition</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="schmidt_utils.html#temfpy.schmidt_utils.StoppingCondition.sectors"><code class="docutils literal notranslate"><span class="pre">StoppingCondition.sectors</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="schmidt_utils.html#temfpy.schmidt_utils.StoppingCondition.chi_max"><code class="docutils literal notranslate"><span class="pre">StoppingCondition.chi_max</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="schmidt_utils.html#temfpy.schmidt_utils.StoppingCondition.svd_min"><code class="docutils literal notranslate"><span class="pre">StoppingCondition.svd_min</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="schmidt_utils.html#temfpy.schmidt_utils.StoppingCondition.degeneracy_tol"><code class="docutils literal notranslate"><span class="pre">StoppingCondition.degeneracy_tol</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="schmidt_utils.html#temfpy.schmidt_utils.StoppingCondition.__call__"><code class="docutils literal notranslate"><span class="pre">StoppingCondition.__call__()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="schmidt_utils.html#temfpy.schmidt_utils.StoppingCondition.truncate"><code class="docutils literal notranslate"><span class="pre">StoppingCondition.truncate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="schmidt_utils.html#temfpy.schmidt_utils.lowest_sums"><code class="docutils literal notranslate"><span class="pre">lowest_sums()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="utils.html#temfpy.utils.HT"><code class="docutils literal notranslate"><span class="pre">HT()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#temfpy.utils.n_slice"><code class="docutils literal notranslate"><span class="pre">n_slice()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#temfpy.utils.block_svd"><code class="docutils literal notranslate"><span class="pre">block_svd()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html#temfpy.utils.normalize_SV"><code class="docutils literal notranslate"><span class="pre">normalize_SV()</span></code></a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TeMFpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pfaffian</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/reference/pfaffian.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-temfpy.pfaffian">
<span id="pfaffian"></span><h1>pfaffian<a class="headerlink" href="#module-temfpy.pfaffian" title="Link to this heading"></a></h1>
<p>Tools for converting Pfaffian wave functions into matrix product states (MPS).</p>
<section id="representing-nambu-correlation-matrices">
<span id="nambu"></span><h2>Representing Nambu correlation matrices<a class="headerlink" href="#representing-nambu-correlation-matrices" title="Link to this heading"></a></h2>
<p>The input of the algorithm is the Nambu correlation matrix that contains
<span class="math notranslate nohighlight">\(\langle cc \rangle\)</span> and <span class="math notranslate nohighlight">\(\langle c^\dagger c \rangle\)</span> correlators
in addition to the standard <span class="math notranslate nohighlight">\(\langle c^\dagger c \rangle\)</span> ones.
Such a correlation matrix may be specified in two different bases:</p>
<ul>
<li><p>In the standard <strong>complex-fermion</strong> basis, the Nambu correlation matrix
is listed as 2×2 blocks <code class="docutils literal notranslate"><span class="pre">C[2*i</span> <span class="pre">:</span> <span class="pre">2*i+2,</span> <span class="pre">2*j</span> <span class="pre">:</span> <span class="pre">2*j+2]</span></code> of</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
    \langle c_j^\dagger c_i         \rangle &amp; \langle c_j c_i         \rangle \\
    \langle c_j^\dagger c_i^\dagger \rangle &amp; \langle c_j c_i^\dagger \rangle
\end{pmatrix},\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(c_i\)</span> and <span class="math notranslate nohighlight">\(c_i^\dagger\)</span> are the standard fermion
annihilation and creation operators on site <span class="math notranslate nohighlight">\(0\le i &lt; L.\)</span></p>
</li>
<li><p>We can also use the <strong>Majorana</strong> basis, defined by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\gamma_{2n} &amp;= (c^\dagger_n + c_n) / \sqrt{2},\\
\gamma_{2n+1} &amp;= i(c^\dagger_n - c_n) / \sqrt{2}\end{split}\]</div>
<p>for all <span class="math notranslate nohighlight">\(0\le n &lt; L\)</span>. In this basis, the correlation matrix is specified
as the matrix <span class="math notranslate nohighlight">\(\langle \gamma_j\gamma_i \rangle.\)</span></p>
</li>
</ul>
</section>
<p class="rubric">Classes</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes" title="temfpy.pfaffian.SchmidtModes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SchmidtModes</span></code></a></p></td>
<td><p>Boguliubov excitations that generate the Schmidt vectors of a Nambu mean-field state.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors" title="temfpy.pfaffian.SchmidtVectors"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SchmidtVectors</span></code></a></p></td>
<td><p>Schmidt vectors of a Nambu mean-field state.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData" title="temfpy.pfaffian.MPSTensorData"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MPSTensorData</span></code></a></p></td>
<td><p>Data for computing one MPS tensor of a Pfaffian state.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">High-level functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#temfpy.pfaffian.correlation_matrix" title="temfpy.pfaffian.correlation_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">correlation_matrix</span></code></a></p></td>
<td><p>Ground-state correlation matrix of a mean-field Nambu Hamiltonian.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#temfpy.pfaffian.parity" title="temfpy.pfaffian.parity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parity</span></code></a></p></td>
<td><p>Fermion parity of a Boguliubov vacuum.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#temfpy.pfaffian.C_to_MPS" title="temfpy.pfaffian.C_to_MPS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">C_to_MPS</span></code></a></p></td>
<td><p>MPS representation of a Nambu mean-field ground state from its correlation matrix.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#temfpy.pfaffian.C_to_iMPS" title="temfpy.pfaffian.C_to_iMPS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">C_to_iMPS</span></code></a></p></td>
<td><p>iMPS representation of a Nambu mean-field state from correlation matrices.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Helper functions</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#temfpy.pfaffian.vector_C2M" title="temfpy.pfaffian.vector_C2M"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_C2M</span></code></a></p></td>
<td><p>Converts mode vectors from complex-fermion to Majorana basis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#temfpy.pfaffian.vector_M2C" title="temfpy.pfaffian.vector_M2C"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vector_M2C</span></code></a></p></td>
<td><p>Converts mode vectors from Majorana to complex-fermion basis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#temfpy.pfaffian.matrix_C2M" title="temfpy.pfaffian.matrix_C2M"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matrix_C2M</span></code></a></p></td>
<td><p>Converts Hamiltonian or correlation matrices from complex-fermion to Majorana basis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#temfpy.pfaffian.matrix_M2C" title="temfpy.pfaffian.matrix_M2C"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matrix_M2C</span></code></a></p></td>
<td><p>Converts Hamiltonian or correlation matrices from Majorana to complex-fermion basis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#temfpy.pfaffian.assert_nambu" title="temfpy.pfaffian.assert_nambu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assert_nambu</span></code></a></p></td>
<td><p>Indicates if a matrix is not Nambu symmetric.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#temfpy.pfaffian.assert_nambu_hamiltonian" title="temfpy.pfaffian.assert_nambu_hamiltonian"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assert_nambu_hamiltonian</span></code></a></p></td>
<td><p>Indicates if a Hamiltonian is not Nambu symmetric.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#temfpy.pfaffian.assert_nambu_correlation" title="temfpy.pfaffian.assert_nambu_correlation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">assert_nambu_correlation</span></code></a></p></td>
<td><p>Indicates if a correlation matrix is not Nambu symmetric.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Static variables</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fermion_site</span></code></p></td>
<td><p>Lattice site prototype for the parity-conserving fermion MPS.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">fermion_leg</span></code></p></td>
<td><p><a class="reference external" href="https://tenpy.readthedocs.io/en/latest/reference/tenpy.linalg.charges.LegCharge.html#tenpy.linalg.charges.LegCharge" title="(in TeNPy v1.0.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">LegCharge</span></code></a> for the single-site Hilbert space of the parity-conserving fermion MPS.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">chinfo</span></code></p></td>
<td><p><a class="reference external" href="https://tenpy.readthedocs.io/en/latest/reference/tenpy.linalg.charges.ChargeInfo.html#tenpy.linalg.charges.ChargeInfo" title="(in TeNPy v1.0.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChargeInfo</span></code></a> for fermion parity conservation.</p></td>
</tr>
</tbody>
</table>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">SchmidtModes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">e</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vR</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtModes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes" title="Link to this definition"></a></dt>
<dd><p>Boguliubov excitations that generate the Schmidt vectors
of a Nambu mean-field state.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.nL">
<span class="sig-name descname"><span class="pre">nL</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.nL" title="Link to this definition"></a></dt>
<dd><p>Size of the left half of the system.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.nR">
<span class="sig-name descname"><span class="pre">nR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.nR" title="Link to this definition"></a></dt>
<dd><p>Size of the right half of the system.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.e">
<span class="sig-name descname"><span class="pre">e</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.e" title="Link to this definition"></a></dt>
<dd><p>array (<a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.n_entangled" title="temfpy.pfaffian.SchmidtModes.n_entangled"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_entangled</span></code></a>,) –
Entangled eigenvalues <span class="math notranslate nohighlight">\(0 &lt; \lambda\le 1/2\)</span> of the
diagonal blocks of the correlation matrix.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.vL">
<span class="sig-name descname"><span class="pre">vL</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.vL" title="Link to this definition"></a></dt>
<dd><p>array (2<a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.nL" title="temfpy.pfaffian.SchmidtModes.nL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nL</span></code></a>, 2<a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.nL" title="temfpy.pfaffian.SchmidtModes.nL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nL</span></code></a>) –
Eigenvectors of the left-left block of the correlation matrix
in the complex-fermion basis, if computed.</p>
<p>The eigenvectors are the columns of the matrix in the order of eigenvalues</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(0\le \lambda\le 1/2\)</span> in increasing order</p></li>
<li><p><span class="math notranslate nohighlight">\(1\ge \lambda\ge 1/2\)</span> in decreasing order,</p></li>
</ul>
<p>i.e. the entangled modes are <code class="docutils literal notranslate"><span class="pre">vL[:,</span> <span class="pre">nL-n_entangled</span> <span class="pre">:</span> <span class="pre">nL]</span></code> (eigenvalues: <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.e" title="temfpy.pfaffian.SchmidtModes.e"><code class="xref py py-attr docutils literal notranslate"><span class="pre">e</span></code></a>)
and <code class="docutils literal notranslate"><span class="pre">vL[:,</span> <span class="pre">-n_entangled:]</span></code> (eigenvalues: <code class="docutils literal notranslate"><span class="pre">1-e</span></code>).</p>
<p>The eigenvectors obey the Nambu symmetry:</p>
<blockquote>
<div><p>vL[::2, nL:] == vL[1::2, :nL].conj()
vL[1::2, nL:] == vL[::2, :nL].conj()</p>
</div></blockquote>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.vR">
<span class="sig-name descname"><span class="pre">vR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.vR" title="Link to this definition"></a></dt>
<dd><p>array (2<a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.nR" title="temfpy.pfaffian.SchmidtModes.nR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nR</span></code></a>, 2<a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.nR" title="temfpy.pfaffian.SchmidtModes.nR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nR</span></code></a>) –
Eigenvectors of the right-right block of the correlation matrix
in the complex-fermion basis, if computed.</p>
<p>The eigenvectors are the columns of the matrix in the order of eigenvalues</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(1/2\ge \lambda\ge 0\)</span> in decreasing order</p></li>
<li><p><span class="math notranslate nohighlight">\(1/2\le \lambda\le 1\)</span> in increasing order,</p></li>
</ul>
<p>i.e. the entangled modes are <code class="docutils literal notranslate"><span class="pre">vR[:,</span> <span class="pre">:n_entangled]</span></code> (eigenvalues: <code class="docutils literal notranslate"><span class="pre">e[::-1]</span></code>)
and <code class="docutils literal notranslate"><span class="pre">vR[:,</span> <span class="pre">nR</span> <span class="pre">:</span> <span class="pre">nR+n_entangled]</span></code> (eigenvalues: <code class="docutils literal notranslate"><span class="pre">1-e[::-1]</span></code>).</p>
<p>They obey the Nambu symmetry:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vR</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="n">nR</span><span class="p">:]</span> <span class="o">==</span> <span class="n">vR</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="n">nR</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
<span class="n">vR</span><span class="p">[</span><span class="mi">1</span><span class="p">::</span><span class="mi">2</span><span class="p">,</span> <span class="n">nR</span><span class="p">:]</span> <span class="o">==</span> <span class="n">vR</span><span class="p">[::</span><span class="mi">2</span><span class="p">,</span> <span class="p">:</span><span class="n">nR</span><span class="p">]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
</pre></div>
</div>
<p>If both <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vL" title="temfpy.pfaffian.SchmidtModes.vL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vL</span></code></a> and <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vR" title="temfpy.pfaffian.SchmidtModes.vR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vR</span></code></a> are known, their entangled components
the left-right block of the Hamiltonian:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">e</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">e</span><span class="p">))</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">((</span><span class="n">S</span><span class="p">,</span> <span class="o">-</span><span class="n">S</span><span class="p">))</span>
<span class="n">vL_entangled</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span> <span class="o">@</span> <span class="n">C</span><span class="p">[:</span><span class="mi">2</span><span class="o">*</span><span class="n">nL</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">nL</span><span class="p">:]</span> <span class="o">@</span> <span class="n">vR_entangled</span><span class="p">[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
<p>However, to better handle fermion anticommutation, the sign of <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vR" title="temfpy.pfaffian.SchmidtModes.vR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vR</span></code></a> is
reversed if the left Boguliubov vacuum is parity odd.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.pL">
<span class="sig-name descname"><span class="pre">pL</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.pL" title="Link to this definition"></a></dt>
<dd><p>0 or 1 –
Parity of the Boguliubov vacuum that annihilates the operators
defined by eigenvectors <code class="docutils literal notranslate"><span class="pre">vL[:,</span> <span class="pre">nL:]</span></code>, if computed.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.pR">
<span class="sig-name descname"><span class="pre">pR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.pR" title="Link to this definition"></a></dt>
<dd><p>0 or 1 –
Parity of the Boguliubov vacuum that annihilates the operators
defined by eigenvectors <code class="docutils literal notranslate"><span class="pre">vR[:,</span> <span class="pre">nR:]</span></code>, if computed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.parity">
<span class="sig-name descname"><span class="pre">parity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'T'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtModes.parity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.parity" title="Link to this definition"></a></dt>
<dd><p>Parity of the Boguliubov vacuum on the specified half of the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>which</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Either “L” for left or “R” for right side
or “T” (default) for the overall parity of the state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.pL" title="temfpy.pfaffian.SchmidtModes.pL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pL</span></code></a>, <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.pR" title="temfpy.pfaffian.SchmidtModes.pR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pR</span></code></a>, or the overall parity, depending on <code class="docutils literal notranslate"><span class="pre">which</span></code>
or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> if the requested parity is unknown.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.n_entangled">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_entangled</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.n_entangled" title="Link to this definition"></a></dt>
<dd><p>Number of entangled orbitals.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'T'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtModes.size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.size" title="Link to this definition"></a></dt>
<dd><p>Size of the specified half or the whole of the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>which</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Either “L” for left or “R” for right side
or “T” (default) for total size.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.nL" title="temfpy.pfaffian.SchmidtModes.nL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nL</span></code></a>, <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.nR" title="temfpy.pfaffian.SchmidtModes.nR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">nR</span></code></a>, or their sum, depending on <code class="docutils literal notranslate"><span class="pre">which</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.vL_entangled">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vL_entangled</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.vL_entangled" title="Link to this definition"></a></dt>
<dd><p>Entangled left Schmidt mode orbitals, if computed.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.vR_entangled">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vR_entangled</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.vR_entangled" title="Link to this definition"></a></dt>
<dd><p>Entangled right Schmidt mode orbitals, if computed.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.mode_vectors">
<span class="sig-name descname"><span class="pre">mode_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entangled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtModes.mode_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.mode_vectors" title="Link to this definition"></a></dt>
<dd><p>Returns the Schmidt mode orbitals on the specified side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>which</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Either “L” for left or “R” for right side.</p></li>
<li><p><strong>entangled</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether to return the entangled (<a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>) or
all (<a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, default) eigenvectors.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Either <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vL" title="temfpy.pfaffian.SchmidtModes.vL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vL</span></code></a> or <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vR" title="temfpy.pfaffian.SchmidtModes.vR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vR</span></code></a>, depending on <code class="docutils literal notranslate"><span class="pre">which</span></code>,
truncated to entangled modes if <code class="docutils literal notranslate"><span class="pre">entangled</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.eigenvalues">
<span class="sig-name descname"><span class="pre">eigenvalues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entangled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtModes.eigenvalues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.eigenvalues" title="Link to this definition"></a></dt>
<dd><p>Returns the Schmidt mode eigenvalues on the specified side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>which</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Either “L” for left or “R” for right side.</p></li>
<li><p><strong>entangled</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether to return the entangled (<a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>) or
all (<a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, default) eigenvalues.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The eigenvalues corresponding to <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.mode_vectors" title="temfpy.pfaffian.SchmidtModes.mode_vectors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">mode_vectors()</span></code></a>
with the same parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.singular_values">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">singular_values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.singular_values" title="Link to this definition"></a></dt>
<dd><p>Singular values of the offdiagonal correlation matrix blocks.</p>
<p>If <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vL_entangled" title="temfpy.pfaffian.SchmidtModes.vL_entangled"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vL_entangled</span></code></a> and <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vR_entangled" title="temfpy.pfaffian.SchmidtModes.vR_entangled"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vR_entangled</span></code></a> are both known, satisfies</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">C_LR</span> <span class="o">==</span> <span class="n">vL_entangled</span> <span class="o">@</span> <span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">@</span> <span class="n">vR_entangled</span><span class="p">[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span>
</pre></div>
</div>
<p>Otherwise, <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.from_correlation_matrix">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_correlation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc_par</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LR'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_parity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtModes.from_correlation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.from_correlation_matrix" title="Link to this definition"></a></dt>
<dd><p>Computes the <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes" title="temfpy.pfaffian.SchmidtModes"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchmidtModes</span></code></a> of a Nambu mean-field state
with correlation matrix <code class="docutils literal notranslate"><span class="pre">C</span></code> for an entanglement cut between
sites <code class="docutils literal notranslate"><span class="pre">x-1</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span></code> (zero-indexed).</p>
<p>We do this by diagonalising the left-left and right-right blocks of <code class="docutils literal notranslate"><span class="pre">C</span></code>.
The eigenvectors give the Schmidt modes, the eigenvalues their
relative weight in the entangled mode. We only treat modes with
eigenvalues away from 0 or 1 by at least <cite>cutoff</cite> as entangled.</p>
<p>We enforce Nambu symmetry by redefining the eigenvectors for
eigenvalues above 1/2 in terms of the other half.</p>
<p>If both left and right modes are computed, the entangled ones are
paired up by ensuring that the eigenvalues sum to 1, and that they
SVD-diagonalise the top right block C_LR and their signs are fixed
so as to handle anticommutation signs optimally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – The correlation matrix.</p></li>
<li><p><strong>x</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Position of the entanglement cut.</p></li>
<li><p><strong>trunc_par</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> | <a class="reference internal" href="schmidt_utils.html#temfpy.schmidt_utils.StoppingCondition" title="temfpy.schmidt_utils.StoppingCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCondition</span></code></a></span>) – <p>Which Schmidt modes should be kept as entangled.</p>
<p>Must be either a <code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCondition</span></code> object
or a dictionary with matching keys.</p>
</p></li>
<li><p><strong>basis</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – whether the correlation matrix is supplied in
Majorana (<code class="docutils literal notranslate"><span class="pre">&quot;M&quot;</span></code>, default) or complex-fermion (<code class="docutils literal notranslate"><span class="pre">&quot;C&quot;</span></code>) basis.</p></li>
<li><p><strong>which</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Whether to return Left and/or Right Schmidt modes.
Must be a combination of <code class="docutils literal notranslate"><span class="pre">&quot;L&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;R&quot;</span></code>.</p></li>
<li><p><strong>diag_tol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – If <code class="docutils literal notranslate"><span class="pre">which==&quot;LR&quot;</span></code>, largest allowed offdiagonal matrix element in
diagonalised / SVD correlation submatrices before an error is raised.</p></li>
<li><p><strong>total_parity</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – Used to infer the parity of the leading Schmidt state on both sides
if Schmidt modes are only computed on one side.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes" title="temfpy.pfaffian.SchmidtModes"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchmidtModes</span></code></a></span></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">trunc_par.svd_min</span></code> is not provided, a default of 1e-6
(i.e., a truncation threshold of 1e-12) is used.</p></li>
<li><p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">trunc_par.degeneracy_tol</span></code> is not provided, the degeneracy tolerance
defaults to 1e-12.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.e_ratio">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">e_ratio</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.e_ratio" title="Link to this definition"></a></dt>
<dd><p><span class="math notranslate nohighlight">\(\log((1-\lambda)/\lambda\)</span> for all eigenvalues in <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.e" title="temfpy.pfaffian.SchmidtModes.e"><code class="xref py py-attr docutils literal notranslate"><span class="pre">e</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.embed_subsets">
<span class="sig-name descname"><span class="pre">embed_subsets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtModes.embed_subsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.embed_subsets" title="Link to this definition"></a></dt>
<dd><p>Given an array of <span class="math notranslate nohighlight">\(\gamma^\dagger\)</span> excitations listed in order
of the left singular vectors, generates the set of excitations on both sides.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sets</strong> (bool <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> (n, <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.n_entangled" title="temfpy.pfaffian.SchmidtModes.n_entangled"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_entangled</span></code></a>)) – <p>Array of occupation numbers.</p>
<p>Each row specifies one Schmidt state by listing whether each
<span class="math notranslate nohighlight">\(\gamma^\dagger\)</span> excitation is “occupied”.</p>
<p>The order of the excitations is consistent with <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vL" title="temfpy.pfaffian.SchmidtModes.vL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vL</span></code></a>.</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul>
<li><p><strong>left_sets</strong> (bool <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> (n, <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.n_entangled" title="temfpy.pfaffian.SchmidtModes.n_entangled"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_entangled</span></code></a>) | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Occupation of excitations in the order of <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vL" title="temfpy.pfaffian.SchmidtModes.vL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vL</span></code></a>.</p>
<p>Returned if <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vL" title="temfpy.pfaffian.SchmidtModes.vL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vL</span></code></a> is not <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p>
</li>
<li><p><strong>right_sets</strong> (bool <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> (n, <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.n_entangled" title="temfpy.pfaffian.SchmidtModes.n_entangled"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_entangled</span></code></a>) | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>) – Occupation of excitations in the order of <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vR" title="temfpy.pfaffian.SchmidtModes.vR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vR</span></code></a>.</p>
<p>Returned if <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vR" title="temfpy.pfaffian.SchmidtModes.vR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vR</span></code></a> is not <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtModes.schmidt_values">
<span class="sig-name descname"><span class="pre">schmidt_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sets</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtModes.schmidt_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtModes.schmidt_values" title="Link to this definition"></a></dt>
<dd><p>Schmidt values of the Schmidt vectors with given excitation numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sets</strong> (bool <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> (n, <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.n_entangled" title="temfpy.pfaffian.SchmidtModes.n_entangled"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_entangled</span></code></a>)) – <p>Array of occupation numbers.</p>
<p>Each row specifies one Schmidt state by listing whether each
<span class="math notranslate nohighlight">\(\gamma^\dagger\)</span> excitation is “occupied”.</p>
<p>The order of the excitations is consistent with <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vL" title="temfpy.pfaffian.SchmidtModes.vL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vL</span></code></a>.</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>λ</strong> – Schmidt values corresponding to the input Schmidt vectors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> (n,)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">SchmidtVectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">left_sets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">right_sets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schmidt_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_parity</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtVectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors" title="Link to this definition"></a></dt>
<dd><p>Schmidt vectors of a Nambu mean-field state.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.modes">
<span class="sig-name descname"><span class="pre">modes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes" title="temfpy.pfaffian.SchmidtModes"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchmidtModes</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.modes" title="Link to this definition"></a></dt>
<dd><p>The Boguliubov excitations underlying the Schmidt vectors.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.left_sets">
<span class="sig-name descname"><span class="pre">left_sets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.left_sets" title="Link to this definition"></a></dt>
<dd><p>bool (<a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.n_schmidt" title="temfpy.pfaffian.SchmidtVectors.n_schmidt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_schmidt</span></code></a>, <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.n_entangled" title="temfpy.pfaffian.SchmidtVectors.n_entangled"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_entangled</span></code></a>) –
Left Schmidt vectors.</p>
<p>Each row contains the occupation of all entangled <span class="math notranslate nohighlight">\(\gamma_L^\dagger\)</span>
excitations, described by <code class="docutils literal notranslate"><span class="pre">vL[:,</span> <span class="pre">:n_entangled]</span></code>, in one left Schmidt vector,
if <code class="xref py py-attr docutils literal notranslate"><span class="pre">modes.vL</span></code> is not <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.right_sets">
<span class="sig-name descname"><span class="pre">right_sets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> <span class="pre">|</span> <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.right_sets" title="Link to this definition"></a></dt>
<dd><p>bool (<a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.n_schmidt" title="temfpy.pfaffian.SchmidtVectors.n_schmidt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_schmidt</span></code></a>, <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.n_entangled" title="temfpy.pfaffian.SchmidtVectors.n_entangled"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_entangled</span></code></a>) –
Right Schmidt vectors.</p>
<p>Each row contains the occupation of all entangled <span class="math notranslate nohighlight">\(\gamma_R^\dagger\)</span>
excitations, described by <code class="docutils literal notranslate"><span class="pre">vR[:,</span> <span class="pre">nR-n_entangled:nR]</span></code>,
in one right Schmidt vector, if <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.vR" title="temfpy.pfaffian.SchmidtVectors.vR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vR</span></code></a> is not <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>.</p>
<p>If both  <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.left_sets" title="temfpy.pfaffian.SchmidtVectors.left_sets"><code class="xref py py-attr docutils literal notranslate"><span class="pre">left_sets</span></code></a> and <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.right_sets" title="temfpy.pfaffian.SchmidtVectors.right_sets"><code class="xref py py-attr docutils literal notranslate"><span class="pre">right_sets</span></code></a> are computed,
they are related by <code class="docutils literal notranslate"><span class="pre">left_sets</span> <span class="pre">=</span> <span class="pre">right_sets[:,</span> <span class="pre">::-1]</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.schmidt_values">
<span class="sig-name descname"><span class="pre">schmidt_values</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.schmidt_values" title="Link to this definition"></a></dt>
<dd><p>array (<a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.n_schmidt" title="temfpy.pfaffian.SchmidtVectors.n_schmidt"><code class="xref py py-attr docutils literal notranslate"><span class="pre">n_schmidt</span></code></a>,):
Schmidt values <span class="math notranslate nohighlight">\(\lambda_\alpha\)</span> corresponding to each Schmidt vector.</p>
<p>Collated by number of Boguliubov excitations (cf. <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.idx_n" title="temfpy.pfaffian.SchmidtVectors.idx_n"><code class="xref py py-attr docutils literal notranslate"><span class="pre">idx_n</span></code></a>);
sorted in decreasing order within each excitation-number sector.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.idx_n">
<span class="sig-name descname"><span class="pre">idx_n</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">slice</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.idx_n" title="Link to this definition"></a></dt>
<dd><p>Dictionary mapping the number of <span class="math notranslate nohighlight">\(\gamma^\dagger\)</span> excitations
to slice of sets/singular values corresponding to that excitation number.</p>
<p>That is, each row in <code class="docutils literal notranslate"><span class="pre">left_sets[idx_n[n]]</span></code> contains n <code class="docutils literal notranslate"><span class="pre">True</span></code> entries.</p>
<p>Slices follow each other in the order 0, 2,…, 1, 3,…</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.idx_parity">
<span class="sig-name descname"><span class="pre">idx_parity</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/functions.html#slice" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">slice</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.idx_parity" title="Link to this definition"></a></dt>
<dd><p>Dictionary mapping the parity (0 or 1) of <span class="math notranslate nohighlight">\(\gamma^\dagger\)</span> excitations
to slice of sets/singular values corresponding to that excitation number.</p>
<p>That is, each row in <code class="docutils literal notranslate"><span class="pre">left_sets[idx_parity[n]]</span></code> contains an even (odd)
number of <code class="docutils literal notranslate"><span class="pre">True</span></code> entries if n=0 (1).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.n_schmidt">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_schmidt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.n_schmidt" title="Link to this definition"></a></dt>
<dd><p>Number of Schmidt vectors.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.n_entangled">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_entangled</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.n_entangled" title="Link to this definition"></a></dt>
<dd><p>Number of entangled orbitals.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.nL">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nL</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.nL" title="Link to this definition"></a></dt>
<dd><p>Size of the left half of the system.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.nR">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.nR" title="Link to this definition"></a></dt>
<dd><p>Size of the right half of the system.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'T'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtVectors.size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.size" title="Link to this definition"></a></dt>
<dd><p>Size of the specified half or the whole of the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>which</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Either “L” for left or “R” for right side
or “T” (default) for total size.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>the appropriate system size.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.vL">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vL</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.vL" title="Link to this definition"></a></dt>
<dd><p>Left Schmidt mode orbitals <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vL" title="temfpy.pfaffian.SchmidtModes.vL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vL</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.vR">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">vR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.vR" title="Link to this definition"></a></dt>
<dd><p>Right Schmidt mode orbitals <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.vR" title="temfpy.pfaffian.SchmidtModes.vR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vR</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.mode_vectors">
<span class="sig-name descname"><span class="pre">mode_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entangled</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtVectors.mode_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.mode_vectors" title="Link to this definition"></a></dt>
<dd><p>Returns the Schmidt mode orbitals on the specified side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>which</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Either “L” for left or “R” for right side.</p></li>
<li><p><strong>entangled</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether to return the entangled (<a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>) or
all (<a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, default) eigenvectors.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Either <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.vL" title="temfpy.pfaffian.SchmidtVectors.vL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vL</span></code></a> or <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.vR" title="temfpy.pfaffian.SchmidtVectors.vR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">vR</span></code></a>, depending on <code class="docutils literal notranslate"><span class="pre">which</span></code>,
truncated to entangled modes if <code class="docutils literal notranslate"><span class="pre">entangled</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.pL">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pL</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.pL" title="Link to this definition"></a></dt>
<dd><p>Parity of left Boguliubov vacuum <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.pL" title="temfpy.pfaffian.SchmidtModes.pL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pL</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.pR">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pR</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></em><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.pR" title="Link to this definition"></a></dt>
<dd><p>Parity of right Boguliubov vacuum <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.pR" title="temfpy.pfaffian.SchmidtModes.pR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pR</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.parity">
<span class="sig-name descname"><span class="pre">parity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'T'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtVectors.parity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.parity" title="Link to this definition"></a></dt>
<dd><p>Parity of the Boguliubov vacuum on the specified half of the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>which</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Either “L” for left or “R” for right side
or “T” (default) for the overall parity of the state.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.pL" title="temfpy.pfaffian.SchmidtModes.pL"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pL</span></code></a>, <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.pR" title="temfpy.pfaffian.SchmidtModes.pR"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pR</span></code></a>,
or the overall parity, depending on <code class="docutils literal notranslate"><span class="pre">which</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.sets">
<span class="sig-name descname"><span class="pre">sets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">which</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtVectors.sets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.sets" title="Link to this definition"></a></dt>
<dd><p>Returns the sets of Boguliubov excitations on the specified side.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>which</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Either “L” for left or “R” for right side.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Either <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.left_sets" title="temfpy.pfaffian.SchmidtVectors.left_sets"><code class="xref py py-attr docutils literal notranslate"><span class="pre">left_sets</span></code></a> or <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.right_sets" title="temfpy.pfaffian.SchmidtVectors.right_sets"><code class="xref py py-attr docutils literal notranslate"><span class="pre">right_sets</span></code></a>, depending on <code class="docutils literal notranslate"><span class="pre">which</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.from_schmidt_modes">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_schmidt_modes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc_par</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtVectors.from_schmidt_modes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.from_schmidt_modes" title="Link to this definition"></a></dt>
<dd><p>Generates the most significant <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors" title="temfpy.pfaffian.SchmidtVectors"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchmidtVectors</span></code></a> from an
instance of <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes" title="temfpy.pfaffian.SchmidtModes"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchmidtModes</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modes</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#temfpy.pfaffian.SchmidtModes" title="temfpy.pfaffian.SchmidtModes"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchmidtModes</span></code></a></span>) – The Schmidt modes.</p></li>
<li><p><strong>trunc_par</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> | <a class="reference internal" href="schmidt_utils.html#temfpy.schmidt_utils.StoppingCondition" title="temfpy.schmidt_utils.StoppingCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCondition</span></code></a></span>) – <p>Specifies which Schmidt states should be kept.</p>
<p>Must be either a <code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCondition</span></code> object
or a dictionary with matching keys.</p>
<p>The filtering function <cite>is_sector</cite> is applied to the number of
<span class="math notranslate nohighlight">\(\gamma^\dagger\)</span> excitations.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors" title="temfpy.pfaffian.SchmidtVectors"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchmidtVectors</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.SchmidtVectors.from_correlation_matrix">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_correlation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc_par</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LR'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_parity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#SchmidtVectors.from_correlation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.SchmidtVectors.from_correlation_matrix" title="Link to this definition"></a></dt>
<dd><p>Computes the most significant <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors" title="temfpy.pfaffian.SchmidtVectors"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchmidtVectors</span></code></a> of a Nambu
mean-field state with correlation matrix C for an entanglement cut
between sites <code class="docutils literal notranslate"><span class="pre">x-1</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span></code> (zero-indexed).</p>
<p>Calls <a class="reference internal" href="#temfpy.pfaffian.SchmidtModes.from_correlation_matrix" title="temfpy.pfaffian.SchmidtModes.from_correlation_matrix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">SchmidtModes.from_correlation_matrix()</span></code></a> (see there for
details of the parameters) and <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.from_schmidt_modes" title="temfpy.pfaffian.SchmidtVectors.from_schmidt_modes"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_schmidt_modes()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors" title="temfpy.pfaffian.SchmidtVectors"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchmidtVectors</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">MPSTensorData</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pfaffian_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qtotal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leg_bra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_sets_bra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_n_bra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leg_idx_bra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leg_ket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_sets_ket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_n_ket</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#MPSTensorData"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData" title="Link to this definition"></a></dt>
<dd><p>Data for computing one MPS tensor of a Pfaffian state.</p>
<ul>
<li><p>If <a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.mode" title="temfpy.pfaffian.MPSTensorData.mode"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mode</span></code></a> is <code class="docutils literal notranslate"><span class="pre">&quot;left&quot;</span></code>, contains an implicit description of the
left canonical tensor</p>
<div class="math notranslate nohighlight">
\[A^{n_i}_{\alpha\beta} =
(\langle n_i | \otimes_g \langle L^{(i-1)}_{\alpha}|)
|L^{(i)}_{\beta} \rangle.\]</div>
</li>
<li><p>If <a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.mode" title="temfpy.pfaffian.MPSTensorData.mode"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mode</span></code></a> is <code class="docutils literal notranslate"><span class="pre">&quot;right&quot;</span></code>, contains an implicit description of the
right canonical tensor</p>
<div class="math notranslate nohighlight">
\[B^{n_i}_{\beta\alpha} =
(\langle R^{(i)}_\alpha| \otimes_g \langle n_i|)
|R^{(i-1)}_\beta \rangle.\]</div>
</li>
</ul>
<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.mode">
<span class="sig-name descname"><span class="pre">mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.mode" title="Link to this definition"></a></dt>
<dd><p>Whether the overlap is between <code class="docutils literal notranslate"><span class="pre">&quot;left&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;right&quot;</span></code> Schmidt vectors.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.norm">
<span class="sig-name descname"><span class="pre">norm</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.norm" title="Link to this definition"></a></dt>
<dd><p>Overlap of the normalised Boguliubov vacua for the two entanglement cuts.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.pfaffian_matrix">
<span class="sig-name descname"><span class="pre">pfaffian_matrix</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.pfaffian_matrix" title="Link to this definition"></a></dt>
<dd><p>Matrix of Pfaffian entries for all bogulon excitations that appear in
at least one Schmidt state.</p>
<p>It is a block matrix, with the first rows/columns corresponding to excitations
on the ket side, followed by excitations on the bra side.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.labels">
<span class="sig-name descname"><span class="pre">labels</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.labels" title="Link to this definition"></a></dt>
<dd><p>Labels of the bra and ket leg(pipe)s.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.qtotal">
<span class="sig-name descname"><span class="pre">qtotal</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.qtotal" title="Link to this definition"></a></dt>
<dd><p>Total fermion parity of the tensor to ensure matching parities in
Schmidt vectors.</p>
<ul class="simple">
<li><p>0 if <code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">==</span> <span class="pre">&quot;left&quot;</span></code>.</p></li>
<li><p>0 if <code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">==</span> <span class="pre">&quot;right&quot;</span></code> and virtual legs are labelled
with fermion parity to the right.</p></li>
<li><p>Otherwise, difference of total fermion parity between
the ket and bra Schmidt vectors.</p></li>
</ul>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.leg_bra">
<span class="sig-name descname"><span class="pre">leg_bra</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://tenpy.readthedocs.io/en/latest/reference/tenpy.linalg.charges.LegCharge.html#tenpy.linalg.charges.LegCharge" title="(in TeNPy v1.0.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">LegCharge</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.leg_bra" title="Link to this definition"></a></dt>
<dd><p>Tensor leg corresponding to the bra Schmidt vectors.</p>
<p>If the tensor contains a physical leg, it is united to the bra leg as
an <cite>unsorted</cite> <a class="reference external" href="https://tenpy.readthedocs.io/en/latest/reference/tenpy.linalg.charges.LegPipe.html#tenpy.linalg.charges.LegPipe" title="(in TeNPy v1.0.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tenpy.linalg.charges.LegPipe</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.new_sets_bra">
<span class="sig-name descname"><span class="pre">new_sets_bra</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.new_sets_bra" title="Link to this definition"></a></dt>
<dd><p>Bra Schmidt vectors in terms of the excitations in <a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.pfaffian_matrix" title="temfpy.pfaffian.MPSTensorData.pfaffian_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pfaffian_matrix</span></code></a>.</p>
<p>Given the block structure of <a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.pfaffian_matrix" title="temfpy.pfaffian.MPSTensorData.pfaffian_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pfaffian_matrix</span></code></a>, each row starts with
a number of <code class="docutils literal notranslate"><span class="pre">False</span></code> entries corresponding to the ket excitations.</p>
<p>If the tensor contains a physical leg, it is double the length of
<a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.sets" title="temfpy.pfaffian.SchmidtVectors.sets"><code class="xref py py-attr docutils literal notranslate"><span class="pre">sets</span></code></a> and contains all Schmidt vectors with the on-site
degree of freedom once empty, one filled.</p>
<p>If needed for matching the bra and ket parities, the Boguliubov orbital
with λ closest to 1/2 is particle-hole flipped.</p>
<p>After all this, the sets are resorted by parity and number of Boguliubov
excitations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.idx_n_bra">
<span class="sig-name descname"><span class="pre">idx_n_bra</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.idx_n_bra" title="Link to this definition"></a></dt>
<dd><p>Analogue of <a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.idx_n" title="temfpy.pfaffian.SchmidtVectors.idx_n"><code class="xref py py-attr docutils literal notranslate"><span class="pre">idx_n</span></code></a> for <a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.new_sets_bra" title="temfpy.pfaffian.MPSTensorData.new_sets_bra"><code class="xref py py-attr docutils literal notranslate"><span class="pre">new_sets_bra</span></code></a>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.leg_idx_bra">
<span class="sig-name descname"><span class="pre">leg_idx_bra</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.leg_idx_bra" title="Link to this definition"></a></dt>
<dd><p>Mapping between <a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.leg_bra" title="temfpy.pfaffian.MPSTensorData.leg_bra"><code class="xref py py-attr docutils literal notranslate"><span class="pre">leg_bra</span></code></a> and <a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.new_sets_bra" title="temfpy.pfaffian.MPSTensorData.new_sets_bra"><code class="xref py py-attr docutils literal notranslate"><span class="pre">new_sets_bra</span></code></a>.</p>
<p>Namely, <code class="docutils literal notranslate"><span class="pre">leg_idx_bra[i]</span></code> gives the index in <a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.leg_bra" title="temfpy.pfaffian.MPSTensorData.leg_bra"><code class="xref py py-attr docutils literal notranslate"><span class="pre">leg_bra</span></code></a>
corresponding to <code class="docutils literal notranslate"><span class="pre">new_sets_bra[i]</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.leg_ket">
<span class="sig-name descname"><span class="pre">leg_ket</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://tenpy.readthedocs.io/en/latest/reference/tenpy.linalg.charges.LegCharge.html#tenpy.linalg.charges.LegCharge" title="(in TeNPy v1.0.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">LegCharge</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.leg_ket" title="Link to this definition"></a></dt>
<dd><p>Tensor leg corresponding to the ket Schmidt vectors.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.new_sets_ket">
<span class="sig-name descname"><span class="pre">new_sets_ket</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.new_sets_ket" title="Link to this definition"></a></dt>
<dd><p>Ket Schmidt vectors in terms of the excitations in <a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.pfaffian_matrix" title="temfpy.pfaffian.MPSTensorData.pfaffian_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pfaffian_matrix</span></code></a>.</p>
<p>Given the block structure of <a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.pfaffian_matrix" title="temfpy.pfaffian.MPSTensorData.pfaffian_matrix"><code class="xref py py-attr docutils literal notranslate"><span class="pre">pfaffian_matrix</span></code></a>, each row ends with
a number of <code class="docutils literal notranslate"><span class="pre">False</span></code> entries corresponding to the bra excitations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.idx_n_ket">
<span class="sig-name descname"><span class="pre">idx_n_ket</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></em><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.idx_n_ket" title="Link to this definition"></a></dt>
<dd><p><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors.idx_n" title="temfpy.pfaffian.SchmidtVectors.idx_n"><code class="xref py py-attr docutils literal notranslate"><span class="pre">idx_n</span></code></a> of the ket Schmidt vector.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.from_schmidt_vectors">
<em class="property"><span class="k"><span class="pre">classmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_schmidt_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Schmidt_bra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Schmidt_ket</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">nambu_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_SV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#MPSTensorData.from_schmidt_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.from_schmidt_vectors" title="Link to this definition"></a></dt>
<dd><p>Builds an <a class="reference internal" href="#temfpy.pfaffian.MPSTensorData" title="temfpy.pfaffian.MPSTensorData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPSTensorData</span></code></a> object from the Schmidt vectors of
the two surrounding entanglement cuts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Schmidt_bra</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors" title="temfpy.pfaffian.SchmidtVectors"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchmidtVectors</span></code></a></span>) – <p>Schmidt vectors on the “bra” side.</p>
<p>That is, for the entanglement cut to the left if <code class="docutils literal notranslate"><span class="pre">mode==&quot;left&quot;</span></code>
or to the right if <code class="docutils literal notranslate"><span class="pre">mode=&quot;right&quot;</span></code>.</p>
<p>Must contain a description of left (right) Schmidt vectors if
<code class="docutils literal notranslate"><span class="pre">mode==&quot;left&quot;</span></code> (<code class="docutils literal notranslate"><span class="pre">&quot;right&quot;</span></code>).</p>
</p></li>
<li><p><strong>Schmidt_ket</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#temfpy.pfaffian.SchmidtVectors" title="temfpy.pfaffian.SchmidtVectors"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchmidtVectors</span></code></a></span>) – <p>Schmidt vectors on the “ket” side.</p>
<p>That is, for the entanglement cut to the right if <code class="docutils literal notranslate"><span class="pre">mode==&quot;left&quot;</span></code>
or to the left if <code class="docutils literal notranslate"><span class="pre">mode=&quot;right&quot;</span></code>.</p>
<p>Must contain a description of left (right) Schmidt vectors if
<code class="docutils literal notranslate"><span class="pre">mode==&quot;left&quot;</span></code> (<code class="docutils literal notranslate"><span class="pre">&quot;right&quot;</span></code>).</p>
</p></li>
<li><p><strong>mode</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Specifies which Schmidt vectors are used to build the MPS tensor
and the canonical form the tensor is computed in.</p></li>
<li><p><strong>nambu_tolerance</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – numerical tolerance for checking Nambu symmetry</p></li>
<li><p><strong>min_SV</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – smallest acceptable singular value of U before it is considered singular</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#temfpy.pfaffian.MPSTensorData" title="temfpy.pfaffian.MPSTensorData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPSTensorData</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="temfpy.pfaffian.MPSTensorData.to_npc_array">
<span class="sig-name descname"><span class="pre">to_npc_array</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#MPSTensorData.to_npc_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.MPSTensorData.to_npc_array" title="Link to this definition"></a></dt>
<dd><p>Computes the MPS tensor as a TeNPy
<a class="reference external" href="https://tenpy.readthedocs.io/en/latest/reference/tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="(in TeNPy v1.0.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a> object.</p>
<p>If <a class="reference internal" href="#temfpy.pfaffian.MPSTensorData.mode" title="temfpy.pfaffian.MPSTensorData.mode"><code class="xref py py-attr docutils literal notranslate"><span class="pre">mode</span></code></a> is “left”, returns a left canonical tensor;
if “right”, a right canonical one.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://tenpy.readthedocs.io/en/latest/reference/tenpy.linalg.np_conserved.Array.html#tenpy.linalg.np_conserved.Array" title="(in TeNPy v1.0.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="high-level-functions">
<h2>High-level functions<a class="headerlink" href="#high-level-functions" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="temfpy.pfaffian.correlation_matrix">
<span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">correlation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#correlation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.correlation_matrix" title="Link to this definition"></a></dt>
<dd><p>Ground-state correlation matrix of a mean-field Nambu Hamiltonian.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – <p>Real-space Nambu Hamiltonian.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">basis</span></code> is given, it must be in the basis
indicated by its first character.</p>
</p></li>
<li><p><strong>basis</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – <p>Basis used by the input and the output.</p>
<p>If specified, it is a string of the form <code class="docutils literal notranslate"><span class="pre">&quot;X-&gt;Y&quot;</span></code>,
where the characters <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span></code> must be M or C:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">X</span></code> controls whether the Hamiltonian is given
in the Majorana or the complex-fermion basis.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Y</span></code> controls whether the correlation matrix is returned
in the Majorana or the complex-fermion basis.</p></li>
</ul>
<p>If not specified, the output is returned in the same basis as the input,
without testing for Nambu symmetry.</p>
</p></li>
<li><p><strong>rtol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Relative tolerance for eigenvalue and matrix-element checks.</p></li>
<li><p><strong>atol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Absolute tolerance for eigenvalue and matrix-element checks.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The correlation matrix C in the format indicated by
the last character of <code class="docutils literal notranslate"><span class="pre">mode</span></code>.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>In Majorana mode <code class="docutils literal notranslate"><span class="pre">&quot;M-&gt;*&quot;</span></code>, the Hamiltonian is expected as the
array of coefficients of <span class="math notranslate nohighlight">\(\gamma_i \gamma_j\)</span>.</p>
<p>In complex-fermion mode <code class="docutils literal notranslate"><span class="pre">&quot;C-&gt;*&quot;</span></code>, the Hamiltonian is expected as
2×2 blocks of coefficients of</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix}
    c_i^\dagger c_j &amp; c_i^\dagger c_j^\dagger \\
    c_i         c_j &amp; c_i         c_j^\dagger
\end{pmatrix}.\end{split}\]</div>
<p>For the format of the correlation matrices, see <a class="reference internal" href="#nambu"><span class="std std-ref">Representing Nambu correlation matrices</span></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="temfpy.pfaffian.parity">
<span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">parity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#parity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.parity" title="Link to this definition"></a></dt>
<dd><p>Fermion parity of a Boguliubov vacuum.</p>
<p>The calculation is based on the Bloch-Messiah decomposition.
If the Boguliubov operators <span class="math notranslate nohighlight">\(\gamma\)</span> that define the vacuum
are related to the standard fermion operators <span class="math notranslate nohighlight">\(c\)</span> by</p>
<div class="math notranslate nohighlight">
\[\begin{split}(\gamma^\dagger, \gamma) = (c^\dagger, c) \begin{pmatrix}
    U &amp; V^* \\ V &amp; U^*
\end{pmatrix},\end{split}\]</div>
<p>the singular values of the matrix <span class="math notranslate nohighlight">\(V\)</span> (and also <span class="math notranslate nohighlight">\(V^*\)</span>) are
(in decreasing order)
<span class="math notranslate nohighlight">\(1, \dots, 1, \sigma_1, \sigma_1, \dots, \sigma_n, \sigma_n, 0, \dots, 0\)</span>.
The parity of the vacuum is that of the number of completely filled modes
(i.e., singular values 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – submatrix of Nambu mode unitary that maps <span class="math notranslate nohighlight">\(c\)</span> to
<span class="math notranslate nohighlight">\(\gamma^\dagger\)</span> (or <span class="math notranslate nohighlight">\(c^\dagger\)</span> to <span class="math notranslate nohighlight">\(\gamma\)</span>).</p></li>
<li><p><strong>tol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – tolerance for considering two numbers equal
(only needed for edge cases of 1 and 2 modes)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>parity as 0 (even) or 1 (odd)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="temfpy.pfaffian.C_to_MPS">
<span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">C_to_MPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc_par</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ortho_center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#C_to_MPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.C_to_MPS" title="Link to this definition"></a></dt>
<dd><p>MPS representation of a Nambu mean-field ground state from its correlation matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Nambu correlation matrix in the basis indicated by <code class="docutils literal notranslate"><span class="pre">basis</span></code>.</p></li>
<li><p><strong>trunc_par</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> | <a class="reference internal" href="schmidt_utils.html#temfpy.schmidt_utils.StoppingCondition" title="temfpy.schmidt_utils.StoppingCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCondition</span></code></a></span>) – <p>Specifies which Schmidt states should be kept.</p>
<p>Must be either a <code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCondition</span></code> object
or a dictionary with matching keys.</p>
<p>Only specify the field <code class="docutils literal notranslate"><span class="pre">sectors</span></code> if you know what you are doing!!</p>
</p></li>
<li><p><strong>basis</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – “M” or “C”, indicates whether the correlation matrix is given
in the Majorana or the complex-fermion basis.</p></li>
<li><p><strong>ortho_center</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Orthogonality centre of the mixed canonical MPS.
Midpoint of the chain by default.</p></li>
<li><p><strong>diag_tol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Largest allowed offdiagonal matrix element in diagonalised / SVD
correlation submatrices before an error is raised.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://tenpy.readthedocs.io/en/latest/reference/tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS" title="(in TeNPy v1.0.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The wave function as a TeNPy <a class="reference external" href="https://tenpy.readthedocs.io/en/latest/reference/tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS" title="(in TeNPy v1.0.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a> object.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">trunc_par.svd_min</span></code> is not provided, the truncation threshold
defaults to 1e-6.</p></li>
<li><p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">trunc_par.degeneracy_tol</span></code> is not provided, the degeneracy tolerance
defaults to 1e-12.</p></li>
</ul>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="temfpy.pfaffian.C_to_iMPS">
<span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">C_to_iMPS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C_short</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_long</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trunc_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_per_cell</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cut</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diag_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unitary_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schmidt_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#C_to_iMPS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.C_to_iMPS" title="Link to this definition"></a></dt>
<dd><p>iMPS representation of a Nambu mean-field state from correlation matrices.</p>
<p>The two correlation matrices are expected to represent the ground states
of a gapped, translation invariant Hamiltonian on two system sizes that
differ by one repeating unit cell.</p>
<p>The method is analogous to <a class="reference internal" href="iMPS.html#temfpy.iMPS.MPS_to_iMPS" title="temfpy.iMPS.MPS_to_iMPS"><code class="xref py py-func docutils literal notranslate"><span class="pre">iMPS.MPS_to_iMPS()</span></code></a>, with two differences:</p>
<ul class="simple">
<li><p>No explicit MPS tensors are computed for the environment of the iMPS unit
cell. Instead, the Schmidt vector overlaps needed for gauge fixing are
computed using the Pfaffian state overlap formulas implemented in
<a class="reference internal" href="#temfpy.pfaffian.MPSTensorData" title="temfpy.pfaffian.MPSTensorData"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPSTensorData</span></code></a>.</p></li>
<li><p>The rightmost tensor is computed directly using the right Schmidt vectors
of the shorter chain. This means that no separate <a class="reference internal" href="iMPS.html#temfpy.iMPS.iMPSError" title="temfpy.iMPS.iMPSError"><code class="xref py py-class docutils literal notranslate"><span class="pre">iMPSError</span></code></a>s
are returned for the right side.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C_short</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Nambu correlation matrix in the basis indicated by <code class="docutils literal notranslate"><span class="pre">basis</span></code>
for the shorter chain.</p></li>
<li><p><strong>C_long</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Nambu correlation matrix in the basis indicated by <code class="docutils literal notranslate"><span class="pre">basis</span></code>
for the longer chain.</p></li>
<li><p><strong>trunc_par</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> | <a class="reference internal" href="schmidt_utils.html#temfpy.schmidt_utils.StoppingCondition" title="temfpy.schmidt_utils.StoppingCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCondition</span></code></a></span>) – <p>Specifies which Schmidt states should be kept.</p>
<p>Must be either a <code class="xref py py-class docutils literal notranslate"><span class="pre">StoppingCondition</span></code> object
or a dictionary with matching keys.</p>
<p>Only specify the field <code class="docutils literal notranslate"><span class="pre">sectors</span></code> if you know what you are doing!!</p>
</p></li>
<li><p><strong>sites_per_cell</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Size of the iMPS unit cell.</p></li>
<li><p><strong>cut</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – First site of the repeating unit cell in <code class="docutils literal notranslate"><span class="pre">C_long</span></code>.</p></li>
<li><p><strong>basis</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – “M” or “C”, indicates whether the correlation matrix is given
in the Majorana or the complex-fermion basis.</p></li>
<li><p><strong>diag_tol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Largest allowed offdiagonal matrix element in diagonalised / SVD
correlation submatrices before an error is raised.</p></li>
<li><p><strong>unitary_tol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Maximum deviation of the gauge rotation matrices from unitarity
before a warning is raised.</p></li>
<li><p><strong>schmidt_tol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Maximum mixing of unequal Schmidt values by the gauge rotation matrices
before a warning is raised.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<a class="reference external" href="https://tenpy.readthedocs.io/en/latest/reference/tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS" title="(in TeNPy v1.0.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a>, <a class="reference internal" href="iMPS.html#temfpy.iMPS.iMPSError" title="temfpy.iMPS.iMPSError"><code class="xref py py-class docutils literal notranslate"><span class="pre">iMPSError</span></code></a>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>iMPS</strong> (<a class="reference external" href="https://tenpy.readthedocs.io/en/latest/reference/tenpy.networks.mps.MPS.html#tenpy.networks.mps.MPS" title="(in TeNPy v1.0.6)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MPS</span></code></a>) – iMPS with unit cell size <code class="docutils literal notranslate"><span class="pre">sites_per_cell</span></code>, constructed from the
additional unit cell of <code class="docutils literal notranslate"><span class="pre">mps_long</span></code>.</p></li>
<li><p><strong>validation_metric</strong> (<a class="reference internal" href="iMPS.html#temfpy.iMPS.iMPSError" title="temfpy.iMPS.iMPSError"><code class="xref py py-class docutils literal notranslate"><span class="pre">iMPSError</span></code></a>) – Errors introduced during the conversion.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">trunc_par.svd_min</span></code> is not provided, the truncation threshold
defaults to 1e-6.</p></li>
<li><p>If <code class="xref py py-attr docutils literal notranslate"><span class="pre">trunc_par.degeneracy_tol</span></code> is not provided, the degeneracy tolerance
defaults to 1e-12.</p></li>
</ul>
</div>
</dd></dl>

</section>
<section id="helper-functions">
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="temfpy.pfaffian.vector_C2M">
<span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">vector_C2M</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#vector_C2M"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.vector_C2M" title="Link to this definition"></a></dt>
<dd><p>Converts mode vectors from complex-fermion to Majorana basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>v</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – <p>A vector or a multidimensional array of vectors in the complex-fermion basis.</p>
<p>In the latter case, the “site” dimension is expected as first
(i.e. several vectors should be supplied as columns of a matrix).</p>
<p>The complex-fermion basis should be listed in the order
<span class="math notranslate nohighlight">\(c^\dagger_1, c_1, \dots, c^\dagger_L, c_L\)</span>.</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The given vectors in the Majorana basis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="temfpy.pfaffian.vector_M2C">
<span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">vector_M2C</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#vector_M2C"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.vector_M2C" title="Link to this definition"></a></dt>
<dd><p>Converts mode vectors from Majorana to complex-fermion basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>v</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – <p>A vector or a multidimensional array of vectors in the Majorana basis.</p>
<p>In the latter case, the “site” dimension is expected as first
(i.e. several vectors should be supplied as columns of a matrix).</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The given vectors in the complex-fermion basis.</p>
<p>The complex-fermion basis is listed in the order
<span class="math notranslate nohighlight">\(c^\dagger_1, c_1, \dots, c^\dagger_L, c_L\)</span>.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="temfpy.pfaffian.matrix_C2M">
<span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">matrix_C2M</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#matrix_C2M"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.matrix_C2M" title="Link to this definition"></a></dt>
<dd><p>Converts Hamiltonian or correlation matrices
from complex-fermion to Majorana basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>H</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – <p>A matrix in the complex-fermion basis.</p>
<p>See the module documentation for the expected layout.</p>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The given matrix in the Majorana basis.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="temfpy.pfaffian.matrix_M2C">
<span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">matrix_M2C</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">H</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#matrix_M2C"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.matrix_M2C" title="Link to this definition"></a></dt>
<dd><p>Converts Hamiltonian or correlation matrices
from Majorana to complex-fermion basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>H</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – A matrix in the Majorana basis.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>The given matrix in the complex-fermion basis.</p>
<p>See the module documentation for the detailed layout.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="temfpy.pfaffian.assert_nambu">
<span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">assert_nambu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/temfpy/pfaffian.html#assert_nambu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#temfpy.pfaffian.assert_nambu" title="Link to this definition"></a></dt>
<dd><p>Indicates if a matrix is not Nambu symmetric.</p>
<p>In Majorana basis, Nambu symmetry requires that the matrix be imaginary
and antisymmetric, except for a constant <code class="docutils literal notranslate"><span class="pre">offset</span> <span class="pre">/</span> <span class="pre">2</span></code> on the diagonal.</p>
<p>In complex-fermion basis, the matrix can be split into blocks
by creation and annihilation operators, e.g.,</p>
<div class="math notranslate nohighlight">
\[\begin{split}C = \begin{pmatrix}
    \langle c_j^\dagger c_i         \rangle &amp; \langle c_j c_i         \rangle \\
    \langle c_j^\dagger c_i^\dagger \rangle &amp; \langle c_j c_i^\dagger \rangle
\end{pmatrix}
=: \begin{pmatrix} C_{11} &amp; C_{12} \\ C_{21} &amp; C_{22} \end{pmatrix},\end{split}\]</div>
<p>which must satisfy</p>
<div class="math notranslate nohighlight">
\[\begin{split}C_{11} + C_{22}^* &amp;= \texttt{offset}\times\mathbb{I} \\
C_{12} &amp;= -C_{21}^*.\end{split}\]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>C</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span>) – Nambu matrix to be checked.</p></li>
<li><p><strong>basis</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – <p>Whether the matrix is supplied in
Majorana (<code class="docutils literal notranslate"><span class="pre">&quot;M&quot;</span></code>) or complex-fermion (<code class="docutils literal notranslate"><span class="pre">&quot;C&quot;</span></code>) basis.</p>
<p>If unspecified, only checks if the matrix is Hermitian.</p>
</p></li>
<li><p><strong>offset</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – <p>Constant diagonal offset.</p>
<p>Should be 0 for Hamiltonians and 1 for correlation matrices.</p>
</p></li>
<li><p><strong>name</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Type of matrix (e.g. <code class="docutils literal notranslate"><span class="pre">&quot;Hamiltonian&quot;</span></code>)</p></li>
<li><p><strong>rtol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Relative tolerance for matrix-element checks.</p></li>
<li><p><strong>atol</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Absolute tolerance for matrix-element checks.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>Regularised Nambu matrix.</p>
<ul class="simple">
<li><p>Skew-Hermitian component is removed.</p></li>
<li><p>In the Majorana basis, small real-part deviations are deleted.</p></li>
<li><p>In the complex-fermion basis, small imaginary parts are pruned
if the matrix is almost real.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AssertionError" title="(in Python v3.14)"><strong>AssertionError</strong></a><strong> | </strong><a class="reference internal" href="testing.html#temfpy.testing.ComparisonWarning" title="temfpy.testing.ComparisonWarning"><strong>testing.ComparisonWarning</strong></a> – If <code class="docutils literal notranslate"><span class="pre">C</span></code> is not Hermitian or Nambu symmetric up to the given tolerance.
    
    Whether an exception or a warning is raised is determined by
    <a class="reference internal" href="testing.html#temfpy.testing.TEST_ACTION" title="temfpy.testing.TEST_ACTION"><code class="xref py py-data docutils literal notranslate"><span class="pre">testing.TEST_ACTION</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="temfpy.pfaffian.assert_nambu_hamiltonian">
<span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">assert_nambu_hamiltonian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Hamiltonian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="headerlink" href="#temfpy.pfaffian.assert_nambu_hamiltonian" title="Link to this definition"></a></dt>
<dd><p>Indicates if a Hamiltonian is not Nambu symmetric.</p>
<p>See <a class="reference internal" href="#temfpy.pfaffian.assert_nambu" title="temfpy.pfaffian.assert_nambu"><code class="xref py py-func docutils literal notranslate"><span class="pre">assert_nambu()</span></code></a> for details. (Arguments <code class="docutils literal notranslate"><span class="pre">offset</span></code> and <code class="docutils literal notranslate"><span class="pre">name</span></code> are fixed.)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="temfpy.pfaffian.assert_nambu_correlation">
<span class="sig-prename descclassname"><span class="pre">temfpy.pfaffian.</span></span><span class="sig-name descname"><span class="pre">assert_nambu_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">C</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'correlation</span> <span class="pre">matrix'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.3)"><span class="pre">ndarray</span></a></span></span><a class="headerlink" href="#temfpy.pfaffian.assert_nambu_correlation" title="Link to this definition"></a></dt>
<dd><p>Indicates if a correlation matrix is not Nambu symmetric.</p>
<p>See <a class="reference internal" href="#temfpy.pfaffian.assert_nambu" title="temfpy.pfaffian.assert_nambu"><code class="xref py py-func docutils literal notranslate"><span class="pre">assert_nambu()</span></code></a> for details. (Arguments <code class="docutils literal notranslate"><span class="pre">offset</span></code> and <code class="docutils literal notranslate"><span class="pre">name</span></code> are fixed.)</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="slater.html" class="btn btn-neutral float-left" title="slater" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="iMPS.html" class="btn btn-neutral float-right" title="iMPS" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Simon Hans Hille, Attila Szabó.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>